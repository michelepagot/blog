<!DOCTYPE html>
<html lang="en-us">
	<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="The radare team">
<meta name="description" content="The blog of radare2">
<meta name="generator" content="Hugo 0.74.3" />
<title>Improving analysis</title>
<link rel="shortcut icon" href="https://radareorg.github.io/blog/images/favicon.ico">
<link rel="stylesheet" href="https://radareorg.github.io/blog/css/style.css">
<link rel="stylesheet" href="https://radareorg.github.io/blog/css/highlight.css">



<link rel="stylesheet" href="https://radareorg.github.io/blog/css/monosocialiconsfont.css">



<link href="https://radareorg.github.io/blog/index.xml" rel="alternate" type="application/rss+xml" title="The Official Radare Blog" />


<meta property="og:title" content="Improving analysis" />
<meta property="og:description" content="One of the main tasks of Radare2 is to statically analyse executables. This includes binary files disassembly, analysing functions setting calling conventions, auto detecting arguments and type propagation. Autodetecting arguments and type propagation are part of my Google Summer of Code task.
New analysis round is added for argument detection. It is architecture independent and supposed to capture all arguments and variables then auto rename them. This analysis round is built on top of ESIL." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://radareorg.github.io/blog/posts/improving-analysis/" />
<meta property="article:published_time" content="2016-05-09T21:00:10+02:00" />
<meta property="article:modified_time" content="2016-05-09T21:00:10+02:00" />


<meta itemprop="name" content="Improving analysis">
<meta itemprop="description" content="One of the main tasks of Radare2 is to statically analyse executables. This includes binary files disassembly, analysing functions setting calling conventions, auto detecting arguments and type propagation. Autodetecting arguments and type propagation are part of my Google Summer of Code task.
New analysis round is added for argument detection. It is architecture independent and supposed to capture all arguments and variables then auto rename them. This analysis round is built on top of ESIL.">
<meta itemprop="datePublished" content="2016-05-09T21:00:10+02:00" />
<meta itemprop="dateModified" content="2016-05-09T21:00:10+02:00" />
<meta itemprop="wordCount" content="334">



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Improving analysis"/>
<meta name="twitter:description" content="One of the main tasks of Radare2 is to statically analyse executables. This includes binary files disassembly, analysing functions setting calling conventions, auto detecting arguments and type propagation. Autodetecting arguments and type propagation are part of my Google Summer of Code task.
New analysis round is added for argument detection. It is architecture independent and supposed to capture all arguments and variables then auto rename them. This analysis round is built on top of ESIL."/>


    </head>
<body>
    <nav class="main-nav">
	
		<a href='https://radareorg.github.io/blog'> <span class="arrow">‚Üê</span>Home</a>
	

	

	
		<a class="cta" href="https://radareorg.github.io/blog/index.xml">Subscribe</a>
	
</nav>

    <section id="wrapper">
        
        
<article class="post">
    <header>
        <h1>Improving analysis</h1>
        <h2 class="subtitle"></h2>
        <h2 class="headline">
        May 9, 2016
        <br>
        
        </h2>
    </header>
    <section id="post-body">
        <p>One of the main tasks of Radare2 is to statically analyse executables. This includes binary files disassembly, analysing functions setting <a href="https://en.wikipedia.org/wiki/Calling_convention">calling conventions</a>, auto detecting arguments and type propagation. Autodetecting arguments and type propagation are part of my <a href="https://summerofcode.withgoogle.com/projects/#4786903815553024">Google Summer of Code</a> task.</p>
<p>New analysis round is added for argument detection. It is architecture independent and supposed to capture all arguments and variables then auto rename them. This analysis round is built on top of <a href="https://github.com/radare/radare2book/blob/master/esil.md">ESIL</a>. It will detect all the <code>base pointer + num</code> and store them as arguments and <code>base pointer - num</code> and store them as variable. The <code>stack pointer + num</code> will always be stored as argument whether it is argument or variable. Identifying whether <code>stack pointer + offset</code> is argument or variable is still work in progress. The analysis on the left is the one generated using the new <code>aa</code> command, while the one on the right is an old instance of the same <code>aa</code>.</p>
<p>![analysis](/blog/images/Screenshot at 2016-05-09 22:32:52.png)</p>
<p><code>Radare2</code> also supports renaming declared variable/arguments this can be done using the command <code>afXn</code>, where <code>X</code> can be:</p>
<ul>
<li><code>a</code> in case of normal arguments</li>
<li><code>A</code> in case of <a href="https://msdn.microsoft.com/en-us/library/6xa169sk.aspx">fastcall</a></li>
<li><code>e</code> in case stack pointer is involved</li>
<li>&lsquo;v&rsquo; if it is a variable</li>
</ul>
<p>For example <code>afan arg_5h my_first_argument</code> will rename <code>arg_5h</code> to be <code>my_first argument</code> You can also set the variable/argument type using the <code>afXt</code> where X is the same as that used for <code>afXn</code>.</p>
<p>The most important thing to know is how to use this analysis round. Fortunately it is embedded in the <code>aa</code> command, so for general purpose uses you won&rsquo;t need to do anything extra, but there will be a scenario where you define new function at some place where no function existed before. In that case you can enforce this analysis round for the newly created function using <code>afCa</code>. It will analyze function located at the current offset and set variables /arguments accordingly.</p>
<p>This is a little example on how to use the new set of commands ;).</p>
<p><a href="https://asciinema.org/a/74hdvfy6ki59hgis9lv88hozb"><img src="https://asciinema.org/a/74hdvfy6ki59hgis9lv88hozb.png" alt="asciicast"></a></p>

    </section>
</article>

<footer id="post-meta" class="clearfix">
    <a href="https://twitter.com/radareorg">
    <img class="avatar" src="https://radareorg.github.io/blog/images/avatar.png">
    <div>
        <span class="dark">The radare team</span>
        <span></span>
    </div>
    </a>
    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fradareorg.github.io%2fblog%2fposts%2fimproving-analysis%2f - Improving%20analysis by @radareorg"><span class="icon-twitter"> https://twitter.com/radareorg</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

    </section>
</footer>



<ul id="post-list" class="archive readmore">
    <h3>Read more</h3>

    
    
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/sleigh_disassembler_backend/">GSoC 2020: SLEIGH Disassembler Backend<aside class="dates">Sep 6 2020</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/rsoc-2019-console-interface-improvement/">RSoC 2019 Final: Console Interface Improvements<aside class="dates">Oct 1 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/rsoc-2019-selection/">Radare2 Summer of Code 2019 Selection Results<aside class="dates">Apr 2 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/radare2-survey/">Radare2 Community Survey Results<aside class="dates">Feb 2 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/radare2-bioinformatics/">Radare2 and bioinformatics: a good match?<aside class="dates">Aug 31 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/cutter_debug/">GSoC 2018 Final: Debugging and Emulation Support for Cutter<aside class="dates">Aug 20 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/cli_improvements/">GSoC 2018 Final: Console Interface Improvementes<aside class="dates">Aug 19 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/gsoc_2018_radeco_cfs/">GSoC 2018: Control Flow Structuring for Radeco-lib<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/gsoc_2018_radeco_pseudo_c_code_generation/">Gsoc 2018 Radeco Pseudo C Code Generation<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/type_inference/">GSoC&#39;18 Final: Type inference<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
</ul>



        <footer id="footer">
    
    <p class="small">
    
        The radare team
    
    </p>
</footer>

    </section>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://radareorg.github.io/blog/js/main.js"></script>
<script src="https://radareorg.github.io/blog/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>





</body>
</html>
