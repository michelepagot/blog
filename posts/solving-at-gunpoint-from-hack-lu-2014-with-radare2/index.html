<!DOCTYPE html>
<html lang="en-us">
	<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="The radare team">
<meta name="description" content="The blog of radare2">
<meta name="generator" content="Hugo 0.74.3" />
<title>Solving &#39;At gunpoint&#39; from hack.lu 2014 with radare2</title>
<link rel="shortcut icon" href="https://radareorg.github.io/blog/images/favicon.ico">
<link rel="stylesheet" href="https://radareorg.github.io/blog/css/style.css">
<link rel="stylesheet" href="https://radareorg.github.io/blog/css/highlight.css">



<link rel="stylesheet" href="https://radareorg.github.io/blog/css/monosocialiconsfont.css">



<link href="https://radareorg.github.io/blog/index.xml" rel="alternate" type="application/rss+xml" title="The Official Radare Blog" />


<meta property="og:title" content="Solving &#39;At gunpoint&#39; from hack.lu 2014 with radare2" />
<meta property="og:description" content="Many thanks to crowell for giving us the permission to publish his writeup on this blog. Feel also free to take a look at depierre&rsquo;s one.
&ldquo;At Gunpoint&rdquo; was a 200 point Reversing challenge in Hack.lu ctf 2014. The description is as follows
You &#39;re the sheriff of a small town, investigating news about a gangster squad passing by. Rumor has it they&#39; re easy to outsmart, so you have just followed one to their encampment by the river." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://radareorg.github.io/blog/posts/solving-at-gunpoint-from-hack-lu-2014-with-radare2/" />
<meta property="article:published_time" content="2014-10-25T15:23:58+02:00" />
<meta property="article:modified_time" content="2014-10-25T15:23:58+02:00" />


<meta itemprop="name" content="Solving &#39;At gunpoint&#39; from hack.lu 2014 with radare2">
<meta itemprop="description" content="Many thanks to crowell for giving us the permission to publish his writeup on this blog. Feel also free to take a look at depierre&rsquo;s one.
&ldquo;At Gunpoint&rdquo; was a 200 point Reversing challenge in Hack.lu ctf 2014. The description is as follows
You &#39;re the sheriff of a small town, investigating news about a gangster squad passing by. Rumor has it they&#39; re easy to outsmart, so you have just followed one to their encampment by the river.">
<meta itemprop="datePublished" content="2014-10-25T15:23:58+02:00" />
<meta itemprop="dateModified" content="2014-10-25T15:23:58+02:00" />
<meta itemprop="wordCount" content="3227">



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Solving &#39;At gunpoint&#39; from hack.lu 2014 with radare2"/>
<meta name="twitter:description" content="Many thanks to crowell for giving us the permission to publish his writeup on this blog. Feel also free to take a look at depierre&rsquo;s one.
&ldquo;At Gunpoint&rdquo; was a 200 point Reversing challenge in Hack.lu ctf 2014. The description is as follows
You &#39;re the sheriff of a small town, investigating news about a gangster squad passing by. Rumor has it they&#39; re easy to outsmart, so you have just followed one to their encampment by the river."/>


    </head>
<body>
    <nav class="main-nav">
	
		<a href='https://radareorg.github.io/blog'> <span class="arrow">←</span>Home</a>
	

	

	
		<a class="cta" href="https://radareorg.github.io/blog/index.xml">Subscribe</a>
	
</nav>

    <section id="wrapper">
        
        
<article class="post">
    <header>
        <h1>Solving &#39;At gunpoint&#39; from hack.lu 2014 with radare2</h1>
        <h2 class="subtitle"></h2>
        <h2 class="headline">
        October 25, 2014
        <br>
        
        </h2>
    </header>
    <section id="post-body">
        <p>Many thanks to <a href="https://twitter.com/jeffreycrowell">crowell</a> for giving us the permission to publish his writeup on this blog. Feel also free to take a look at depierre&rsquo;s <a href="http://depier.re/hacklu_2k14_gunpoint_200/">one</a>.</p>
<p>&ldquo;At Gunpoint&rdquo; was a 200 point Reversing challenge in Hack.lu ctf 2014. The description is as follows</p>
<pre><code>You 're the sheriff of a small town, investigating news about a gangster squad
passing by. Rumor has it they' re easy to outsmart, so you have just followed
one to their encampment by the river.You know you can easily take them out one
by one, if you would just know their secret handshake..
</code></pre><p>Let&rsquo;s see what we are working with.</p>
<pre><code>minishwoods hacklu/gunpoint» file gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat
gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat: Gameboy ROM: &quot;FLUX&quot;, [ROM ONLY], ROM: 256Kbit
</code></pre><p>So it is a Gameboy ROM. I load it up in <a href="http://sourceforge.net/projects/vba/">VisualBoyAdvance</a> and see what the game is.</p>
<p><img src="/blog/images/pVD3Je8-1.png" alt="running_game_1.png"></p>
<p>It is a static image, and after some time, we receive this text.</p>
<p><img src="/blog/images/meh.png" alt="running_game_2.png"></p>
<p>Looks like we will have to put in some inputs from the joypad to get the flag. It is a crackme style but for the Gameboy! Sounds fun.</p>
<p>First thing to do is to find out how the Gameboy interprets button presses.</p>
<p>According to this document <a href="http://www.semis.demon.co.uk/Gameboy/Gbspec.txt">here</a>, the joypad is memory mapped to <code>0xFF00</code>. So now that we have some sort of idea of what we are looking for, let&rsquo;s load up the ROM in radare2!</p>
<p>First, let&rsquo;s run the auto analysis and see what r2 can give us for functions. We run <code>aa</code> to analyze the binary, then <code>afl</code> to list the functions.</p>
<pre><code>minishwoods hacklu/gunpoint » radare2 ./gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat
 -- Fuck you, fuck you in the mouth, with a chair!
 [0x00000100]&gt; aa
 [0x00000100]&gt; afl
 0x00000100  35  1  entry0
 0x00000150  133  8  main
 0x00000123  178  8  fcn.00000123
</code></pre><p>Hm&hellip; not so great, just 3 functions. (note, since after the ctf ended, the latest git of r2 is much better at detecting Gameboy functions!)</p>
<p>Let&rsquo;s try to find usage of the joypad. Really what we are looking for is a load or store from <code>0xFF00</code>, but I am lazy, and the ROM is small, so we can just disassembly everything and grep for it!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">[0</span><span style="color:#a6e22e">x00000100</span>]<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#66d9ef">s</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">; pd 10000 | grep ff00
</span><span style="color:#75715e"></span><span style="color:#66d9ef">Do</span> <span style="color:#66d9ef">you</span> <span style="color:#66d9ef">want</span> <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">print</span> <span style="color:#ae81ff">566</span><span style="color:#66d9ef">.8K</span> <span style="color:#66d9ef">chars</span><span style="color:#960050;background-color:#1e0010">?</span> (<span style="color:#66d9ef">y</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">N</span>)
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000193</span>    <span style="color:#66d9ef">e2</span>           <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>], <span style="color:#66d9ef">a</span>
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000c84</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e63</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e65</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e67</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e71</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e73</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e75</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e77</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e79</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e7b</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e7d</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e88</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00002307</span>    <span style="color:#66d9ef">e2</span>           <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>], <span style="color:#66d9ef">a</span>
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00002317</span>    <span style="color:#66d9ef">f2</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>]
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0000233f</span>    <span style="color:#66d9ef">f2</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>]
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00002342</span>    <span style="color:#66d9ef">f2</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>]
            <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00002717</span>    <span style="color:#66d9ef">f2</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">c</span>]
</code></pre></div><p>Perfect, not many uses, and it looks like there are a few small groups that are touching <code>0xFF00</code>, so probably just a few functions that interact with the joypad.</p>
<p>So, seek to 0x1e63 (<code>s 0x1e63</code>), then open up visual mode with <code>V</code>. Scroll up a bit to see that at <code>0x1e5f</code> is a <code>ret</code>, then <code>0x1e60</code> is <code>push bc</code>. The push instruction looks to be the start of a function that interacts with the joypad quite a bit. So we can define this as a function from visual mode with <code>df</code>. (If you have a newer version of r2, this is probably already done for you).</p>
<p>Checking back at the Gameboy document, The function looks very similar, in fact, it nearly identical to the joypad reader from Ms. PacMan.</p>
<p>Code from Ms. PacMan is here</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm">       <span style="color:#a6e22e">Example</span> <span style="color:#66d9ef">code</span>:

          Game: <span style="color:#a6e22e">Ms.</span> <span style="color:#66d9ef">Pacman</span>
          Address: <span style="color:#a6e22e">$3b1</span>

        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,<span style="color:#66d9ef">$20</span>       <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">bit</span> <span style="color:#ae81ff">5</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#66d9ef">$20</span>
        <span style="color:#a6e22e">LD</span> (<span style="color:#66d9ef">$FF00</span>),<span style="color:#66d9ef">A</span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">P14</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">setting</span> <span style="color:#66d9ef">it</span> <span style="color:#66d9ef">low</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">wait</span> <span style="color:#66d9ef">a</span> <span style="color:#66d9ef">few</span> <span style="color:#66d9ef">cycles</span>
        <span style="color:#a6e22e">CPL</span>            <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">complement</span> <span style="color:#66d9ef">A</span>
        <span style="color:#a6e22e">AND</span> <span style="color:#66d9ef">$0F</span>        <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">get</span> <span style="color:#66d9ef">only</span> <span style="color:#66d9ef">first</span> <span style="color:#ae81ff">4</span> <span style="color:#66d9ef">bits</span>
        <span style="color:#a6e22e">SWAP</span> <span style="color:#66d9ef">A</span>         <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">swap</span> <span style="color:#66d9ef">it</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">B</span>,<span style="color:#66d9ef">A</span>         <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">store</span> <span style="color:#66d9ef">A</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">B</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,<span style="color:#66d9ef">$10</span>
        <span style="color:#a6e22e">LD</span> (<span style="color:#66d9ef">$FF00</span>),<span style="color:#66d9ef">A</span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">P15</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">setting</span> <span style="color:#66d9ef">it</span> <span style="color:#66d9ef">low</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF00</span>)   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">Wait</span> <span style="color:#66d9ef">a</span> <span style="color:#66d9ef">few</span> <span style="color:#66d9ef">MORE</span> <span style="color:#66d9ef">cycles</span>
        <span style="color:#a6e22e">CPL</span>            <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">complement</span> (<span style="color:#66d9ef">invert</span>)
        <span style="color:#a6e22e">AND</span> <span style="color:#66d9ef">$0F</span>        <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">get</span> <span style="color:#66d9ef">first</span> <span style="color:#ae81ff">4</span> <span style="color:#66d9ef">bits</span>
        <span style="color:#a6e22e">OR</span> <span style="color:#66d9ef">B</span>           <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">put</span> <span style="color:#66d9ef">A</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">B</span> <span style="color:#66d9ef">together</span>

        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">B</span>,<span style="color:#66d9ef">A</span>         <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">store</span> <span style="color:#66d9ef">A</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">D</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,(<span style="color:#66d9ef">$FF8B</span>)   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">read</span> <span style="color:#66d9ef">old</span> <span style="color:#66d9ef">joy</span> <span style="color:#66d9ef">data</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">ram</span>
        <span style="color:#a6e22e">XOR</span> <span style="color:#66d9ef">B</span>          <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">toggle</span> <span style="color:#66d9ef">w</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">current</span> <span style="color:#66d9ef">button</span> <span style="color:#66d9ef">bit</span>
        <span style="color:#a6e22e">AND</span> <span style="color:#66d9ef">B</span>          <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">get</span> <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">button</span> <span style="color:#66d9ef">bit</span> <span style="color:#66d9ef">back</span>
        <span style="color:#a6e22e">LD</span> (<span style="color:#66d9ef">$FF8C</span>),<span style="color:#66d9ef">A</span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">save</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">Joydata</span> <span style="color:#66d9ef">storage</span>
        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,<span style="color:#66d9ef">B</span>         <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">put</span> <span style="color:#66d9ef">original</span> <span style="color:#66d9ef">value</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">A</span>
        <span style="color:#a6e22e">LD</span> (<span style="color:#66d9ef">$FF8B</span>),<span style="color:#66d9ef">A</span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">store</span> <span style="color:#66d9ef">it</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">old</span> <span style="color:#66d9ef">joy</span> <span style="color:#66d9ef">data</span>


        <span style="color:#a6e22e">LD</span> <span style="color:#66d9ef">A</span>,<span style="color:#66d9ef">$30</span>       <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">deselect</span> <span style="color:#66d9ef">P14</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">P15</span>
        <span style="color:#a6e22e">LD</span> (<span style="color:#66d9ef">$FF00</span>),<span style="color:#66d9ef">A</span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">RESET</span> <span style="color:#66d9ef">Joypad</span>
        <span style="color:#a6e22e">RET</span>            <span style="color:#960050;background-color:#1e0010">&lt;</span>- <span style="color:#66d9ef">Return</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">Subroutine</span>

          <span style="color:#a6e22e">The</span> <span style="color:#66d9ef">button</span> <span style="color:#66d9ef">values</span> <span style="color:#66d9ef">using</span> <span style="color:#66d9ef">the</span> <span style="color:#66d9ef">above</span> <span style="color:#66d9ef">method</span> <span style="color:#66d9ef">are</span> <span style="color:#66d9ef">such</span>:
          <span style="color:#a6e22e">$80</span> - <span style="color:#66d9ef">Start</span>             <span style="color:#66d9ef">$8</span> - <span style="color:#66d9ef">Down</span>
          <span style="color:#a6e22e">$40</span> - <span style="color:#66d9ef">Select</span>            <span style="color:#66d9ef">$4</span> - <span style="color:#66d9ef">Up</span>
          <span style="color:#a6e22e">$20</span> - <span style="color:#66d9ef">B</span>                 <span style="color:#66d9ef">$2</span> - <span style="color:#66d9ef">Left</span>
          <span style="color:#a6e22e">$10</span> - <span style="color:#66d9ef">A</span>                 <span style="color:#66d9ef">$1</span> - <span style="color:#66d9ef">Right</span>

          <span style="color:#a6e22e">Let</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">s</span> <span style="color:#66d9ef">say</span> <span style="color:#66d9ef">we</span> <span style="color:#66d9ef">held</span> <span style="color:#66d9ef">down</span> <span style="color:#66d9ef">A</span>, <span style="color:#66d9ef">Start</span>, <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">Up.</span>
          <span style="color:#a6e22e">The</span> <span style="color:#66d9ef">value</span> <span style="color:#66d9ef">returned</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">accumulator</span> <span style="color:#66d9ef">A</span> <span style="color:#66d9ef">would</span> <span style="color:#66d9ef">be</span> <span style="color:#66d9ef">$94jkj</span>
</code></pre></div><p>And the code we have here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fcn</span>) <span style="color:#66d9ef">fcn.00001e60</span> <span style="color:#ae81ff">45</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e60</span>    <span style="color:#66d9ef">c5</span>           <span style="color:#66d9ef">push</span> <span style="color:#66d9ef">bc</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e61</span>    <span style="color:#ae81ff">3</span><span style="color:#66d9ef">e20</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e63</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e65</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e67</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e69</span>    <span style="color:#ae81ff">2</span><span style="color:#66d9ef">f</span>           <span style="color:#66d9ef">cpl</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e6a</span>    <span style="color:#66d9ef">e60f</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x0f</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e6c</span>    <span style="color:#66d9ef">cb37</span>         <span style="color:#66d9ef">swap</span> <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e6e</span>    <span style="color:#ae81ff">47</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">b</span>, <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e6f</span>    <span style="color:#ae81ff">3</span><span style="color:#66d9ef">e10</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, <span style="color:#ae81ff">0x10</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e71</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e73</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e75</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e77</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e79</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e7b</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e7d</span>    <span style="color:#66d9ef">f000</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#ae81ff">0xff00</span>]
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e7f</span>    <span style="color:#ae81ff">2</span><span style="color:#66d9ef">f</span>           <span style="color:#66d9ef">cpl</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e80</span>    <span style="color:#66d9ef">e60f</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x0f</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e82</span>    <span style="color:#66d9ef">b0</span>           <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">b</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e83</span>    <span style="color:#66d9ef">cb37</span>         <span style="color:#66d9ef">swap</span> <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e85</span>    <span style="color:#ae81ff">47</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">b</span>, <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e86</span>    <span style="color:#ae81ff">3</span><span style="color:#66d9ef">e30</span>         <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, <span style="color:#ae81ff">0x30</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#75715e">;  JOYPAD
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e88</span>    <span style="color:#66d9ef">e000</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#ae81ff">0xff00</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e8a</span>    <span style="color:#ae81ff">78</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, <span style="color:#66d9ef">b</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e8b</span>    <span style="color:#66d9ef">c1</span>           <span style="color:#66d9ef">pop</span> <span style="color:#66d9ef">bc</span>
<span style="color:#960050;background-color:#1e0010">\</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e8c</span>    <span style="color:#66d9ef">c9</span>           <span style="color:#66d9ef">ret</span>
</code></pre></div><p>Looks really similar, doesn&rsquo;t it? ;) So we can see here, that value of the joypad is now stored in register A from <code>0x1e8a</code>. Seek to the beginning of the function and define the function with a name like <code>read_joypad</code> with <code>dr</code> in visual mode.</p>
<p>So, now that we know what reads the joypad, we can find the xrefs to find out the checking routine. From visual mode, at the top of <code>read_joypad</code>, hit <code>x</code> to see the xrefs.</p>
<pre><code>[GOTO XREF]&gt; 65 ./gunpoint_2daf5fe3fb236b398ff9e5705a058a7f.dat]&gt; pd $r @ read_joypad
[0] 0x00001e60 CODE (CALL) XREF 0x00001e54 (fcn.00001e50)
[1] 0x00001e60 CODE (CALL) XREF 0x00001e8d (fcn.00001e8d)
[2] 0x00001e60 CODE (CALL) XREF 0x00001e94 (fcn.00001e94)
</code></pre><p>We see 3 cross references, which means we have 3 other functions calling the <code>read_joypad</code> function.</p>
<p>Looking at xref2, we see that the joypad is read, and then the value is also stored into register <code>e</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fcn</span>) <span style="color:#66d9ef">load_joypad_to_e</span> <span style="color:#ae81ff">5</span>
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e94</span>    <span style="color:#66d9ef">cd601e</span>       <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">read_joypad</span> <span style="color:#75715e">;[1]
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>             <span style="color:#66d9ef">read_joypad</span>(<span style="color:#ae81ff">0x0</span>, <span style="color:#ae81ff">0x0</span>, <span style="color:#ae81ff">0x0</span>)
<span style="color:#960050;background-color:#1e0010">|</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e97</span>    <span style="color:#ae81ff">5</span><span style="color:#66d9ef">f</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">e</span>, <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">\</span>          <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00001e98</span>    <span style="color:#66d9ef">c9</span>           <span style="color:#66d9ef">ret</span>
</code></pre></div><p>Essentially, in pseudocode</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">a <span style="color:#f92672">=</span> read_joypad();
e <span style="color:#f92672">=</span> a;
</code></pre></div><p>For some time I was stuck here, as it didn&rsquo;t seem that the <code>load_joypad_to_e</code> was called anywhere, r2 did not find any calls, but we can use the same trick we used to find the references to the memory mapped io of the joypad to find references to the <code>load_joypad_to_e</code>.</p>
<pre><code>[0x00001e94]&gt; s 0; pd 10000 | grep load_joypad
Do you want to print 566.8K chars? (y/N)
  --------&gt; 0x00000d6f    cd941e       call load_joypad_to_e
          &gt;    load_joypad_to_e()
  / (fcn) load_joypad_to_e 5
</code></pre><p>Looks like it is referenced just once, so seek to <code>0xd6f</code> and open visual mode. Looks to be the beginning of a big block of code, define as a function and start reversing. I defined it as <code>checker_loop</code> once I realized that this is the main crackme part.</p>
<p>It looks like the auto analysis fails to detect the proper end of the function. This is fine, because we can tell r2 exactly how long the function is ourselves.</p>
<p>Looking at the code, the last instruction of the function is the <code>ret</code> at <code>0xf01</code>, so, by starting at <code>0xd6f</code> the function should be 403 bytes. Just
define the function like this</p>
<p><code>[0x00000e5f]&gt; af+ 0xd6f 403 checker_loop</code></p>
<p>Now we can disassemble the entire function with <code>pdf @ checker_loop</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fcn</span>) <span style="color:#66d9ef">checker_loop</span> <span style="color:#ae81ff">403</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d6f</span>    <span style="color:#66d9ef">cd941e</span>       <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">load_joypad_to_e</span>
<span style="color:#960050;background-color:#1e0010">|</span>              <span style="color:#a6e22e">load_joypad_to_e</span>()
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d72</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d75</span>    <span style="color:#ae81ff">73</span>           <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#66d9ef">e</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d76</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a1c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a1</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d79</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d7a</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d7d</span>    <span style="color:#66d9ef">be</span>           <span style="color:#66d9ef">cp</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>       <span style="color:#960050;background-color:#1e0010">,=&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d7e</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">,==&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d80</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|`-&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d83</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d86</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d87</span>    <span style="color:#66d9ef">fe0d</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x0d</span>
<span style="color:#960050;background-color:#1e0010">|</span>     <span style="color:#960050;background-color:#1e0010">,===&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d89</span>    <span style="color:#66d9ef">c2990d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0d99</span>
<span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">,====&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d8c</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (checker_loop)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>   ,<span style="color:#960050;background-color:#1e0010">=====&lt;</span> <span style="color:#ae81ff">0x00000d8e</span>    <span style="color:#66d9ef">c3990d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0d99</span> <span style="color:#75715e">; (checker_loop)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|`</span>----<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000d91</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">||</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d94</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">,======&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d96</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|`-`---&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d99</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d9c</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d9d</span>    <span style="color:#66d9ef">e604</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x04</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">,=======&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000d9f</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000da1</span>    <span style="color:#66d9ef">c3c90d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000dc9</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">`-------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000da4</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000da7</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000da8</span>    <span style="color:#66d9ef">b7</span>           <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000da9</span>    <span style="color:#66d9ef">caba0d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0dba</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dac</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000daf</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000db0</span>    <span style="color:#66d9ef">fe04</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x04</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000db2</span>    <span style="color:#66d9ef">c2c10d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0dc1</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000db5</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (checker_loop)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000db7</span>    <span style="color:#66d9ef">c3c10d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0dc1</span> <span style="color:#75715e">; (checker_loop)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000dba</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dbd</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dbe</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dc1</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dc4</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dc6</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000dc9</span> <span style="color:#ae81ff">49</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dc9</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dcc</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dcd</span>    <span style="color:#66d9ef">e601</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x01</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dcf</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dd1</span>    <span style="color:#66d9ef">c3fa0d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000dfa</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dd4</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dd7</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dd8</span>    <span style="color:#66d9ef">fe01</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x01</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dda</span>    <span style="color:#66d9ef">caeb0d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0deb</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ddd</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000de0</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000de1</span>    <span style="color:#66d9ef">fe05</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x05</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000de3</span>    <span style="color:#66d9ef">c2f20d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0df2</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000de6</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000dc9)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000de8</span>    <span style="color:#66d9ef">c3f20d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0df2</span> <span style="color:#75715e">; (loc.00000dc9)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000deb</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dee</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000def</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000df2</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000df5</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">\</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000df7</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000dfa</span> <span style="color:#ae81ff">49</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dfa</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dfd</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000dfe</span>    <span style="color:#66d9ef">e608</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x08</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e00</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e02</span>    <span style="color:#66d9ef">c32b0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e2b</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e05</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e08</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e09</span>    <span style="color:#66d9ef">fe02</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x02</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e0b</span>    <span style="color:#66d9ef">ca1c0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0e1c</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e0e</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e11</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e12</span>    <span style="color:#66d9ef">fe06</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x06</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e14</span>    <span style="color:#66d9ef">c2230e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0e23</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e17</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000dfa)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000e19</span>    <span style="color:#66d9ef">c3230e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0e23</span> <span style="color:#75715e">; (loc.00000dfa)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000e1c</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e1f</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e20</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e23</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e26</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">\</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e28</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000e2b</span> <span style="color:#ae81ff">49</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e2b</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e2e</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e2f</span>    <span style="color:#66d9ef">e602</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x02</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e31</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e33</span>    <span style="color:#66d9ef">c35c0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e5c</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e36</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e39</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e3a</span>    <span style="color:#66d9ef">fe03</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e3c</span>    <span style="color:#66d9ef">ca4d0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0e4d</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e3f</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e42</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e43</span>    <span style="color:#66d9ef">fe07</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x07</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e45</span>    <span style="color:#66d9ef">c2540e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0e54</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e48</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000e2b)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000e4a</span>    <span style="color:#66d9ef">c3540e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0e54</span> <span style="color:#75715e">; (loc.00000e2b)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000e4d</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e50</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e51</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e54</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e57</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">\</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e59</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000e5c</span> <span style="color:#ae81ff">95</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e5c</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e5f</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e60</span>    <span style="color:#66d9ef">e610</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x10</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e62</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e64</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e67</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e6a</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e6b</span>    <span style="color:#66d9ef">fe0a</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x0a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e6d</span>    <span style="color:#66d9ef">ca7e0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0e7e</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e70</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e73</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e74</span>    <span style="color:#66d9ef">fe0b</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x0b</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e76</span>    <span style="color:#66d9ef">c2850e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0e85</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e79</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000e5c)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000e7b</span>    <span style="color:#66d9ef">c3850e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0e85</span> <span style="color:#75715e">; (loc.00000e5c)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000e7e</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e81</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e82</span>    <span style="color:#66d9ef">c38a0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000e8a</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e85</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>   <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e88</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>        <span style="color:#75715e">; XREFS: JMP 0x00000dbe  JMP 0x00000dc6  JMP 0x00000def
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>        <span style="color:#75715e">; XREFS: JMP 0x00000df7  JMP 0x00000e20  JMP 0x00000e28
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>        <span style="color:#75715e">; XREFS: JMP 0x00000e51  JMP 0x00000e59  JMP 0x00000e82
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>  <span style="color:#960050;background-color:#1e0010">|</span>        <span style="color:#75715e">; XREFS: JMP 0x00000e64
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000e8a</span> <span style="color:#ae81ff">49</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">-`------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e8a</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e8d</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e8e</span>    <span style="color:#66d9ef">e620</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e90</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e92</span>    <span style="color:#66d9ef">c3bb0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ebb</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e95</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e98</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e99</span>    <span style="color:#66d9ef">fe08</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x08</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e9b</span>    <span style="color:#66d9ef">caac0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">Z</span>, <span style="color:#ae81ff">0x0eac</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000e9e</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ea1</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ea2</span>    <span style="color:#66d9ef">fe09</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x09</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ea4</span>    <span style="color:#66d9ef">c2b30e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0eb3</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ea7</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000e8a)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000ea9</span>    <span style="color:#66d9ef">c3b30e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0eb3</span> <span style="color:#75715e">; (loc.00000e8a)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000eac</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eaf</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eb0</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eb3</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eb6</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">\</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eb8</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000ebb</span> <span style="color:#ae81ff">43</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ebb</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ebe</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ebf</span>    <span style="color:#66d9ef">e680</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x80</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ec1</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ec3</span>    <span style="color:#66d9ef">c3e60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ee6</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ec6</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ec9</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eca</span>    <span style="color:#66d9ef">fe0c</span>         <span style="color:#66d9ef">cp</span> <span style="color:#ae81ff">0x0c</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ecc</span>    <span style="color:#66d9ef">c2de0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x0ede</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ecf</span>    <span style="color:#ae81ff">1803</span>         <span style="color:#66d9ef">jr</span> <span style="color:#ae81ff">0x03</span> <span style="color:#75715e">; (loc.00000ebb)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#ae81ff">0x00000ed1</span>    <span style="color:#66d9ef">c3de0e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#ae81ff">0x0ede</span> <span style="color:#75715e">; (loc.00000ebb)
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span> --------<span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x00000ed4</span>    <span style="color:#66d9ef">cd0002</span>       <span style="color:#66d9ef">call</span> <span style="color:#ae81ff">0x0200</span>
<span style="color:#960050;background-color:#1e0010">|</span>         <span style="color:#960050;background-color:#1e0010">&gt;</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000200</span>() <span style="color:#75715e">; main+176
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#ae81ff">0x00000ed7</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eda</span>    <span style="color:#ae81ff">34</span>           <span style="color:#66d9ef">inc</span> [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000edb</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ede</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ee1</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">\</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ee3</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000ee6</span> <span style="color:#ae81ff">27</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ee6</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ee9</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eea</span>    <span style="color:#66d9ef">e640</span>         <span style="color:#66d9ef">and</span> <span style="color:#ae81ff">0x40</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eec</span>    <span style="color:#ae81ff">2003</span>         <span style="color:#66d9ef">jr</span> <span style="color:#66d9ef">nZ</span>, <span style="color:#ae81ff">0x03</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">========&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000eee</span>    <span style="color:#66d9ef">c3f60e</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">loc.00000ef6</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">--------&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ef1</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a0c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a0</span>
<span style="color:#960050;background-color:#1e0010">|</span>      <span style="color:#960050;background-color:#1e0010">|</span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ef4</span>    <span style="color:#ae81ff">3600</span>         <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#ae81ff">0x00</span>
<span style="color:#960050;background-color:#1e0010">|-</span> <span style="color:#a6e22e">loc.00000ef6</span> <span style="color:#ae81ff">11</span>
<span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#960050;background-color:#1e0010">-----`--&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ef6</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a2c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a2</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000ef9</span>    <span style="color:#ae81ff">7</span><span style="color:#66d9ef">e</span>           <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">a</span>, [<span style="color:#66d9ef">hl</span>]
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000efa</span>    <span style="color:#ae81ff">21</span><span style="color:#66d9ef">a1c0</span>       <span style="color:#66d9ef">ld</span> <span style="color:#66d9ef">hl</span>, <span style="color:#ae81ff">0xc0a1</span>
<span style="color:#960050;background-color:#1e0010">|</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000efd</span>    <span style="color:#ae81ff">77</span>           <span style="color:#66d9ef">ld</span> [<span style="color:#66d9ef">hl</span>], <span style="color:#66d9ef">a</span>
<span style="color:#960050;background-color:#1e0010">\</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000efe</span>    <span style="color:#66d9ef">c36f0d</span>       <span style="color:#66d9ef">jp</span> <span style="color:#66d9ef">checker_loop</span>
<span style="color:#960050;background-color:#1e0010">\</span>           <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x00000f01</span>    <span style="color:#66d9ef">c9</span>           <span style="color:#66d9ef">ret</span>
</code></pre></div><p>Yikes! This is a long function. With r2 we have a lot of tools at our disposal though, and we can use the graph view to get a better high-level understanding of the code.</p>
<p>We can load up a graph visualization with either <code>VV</code> for an ascii view, or a graphviz view with <code>ag</code>. I like to use the graphviz output with xdot.</p>
<p><code>[0x00000d6f]&gt; ag $$ | xdot</code></p>
<p>And we get a nice graph like this.  I have some annotations on mine, from reversing the function myself. This is helpful for looking at the overall way the function works. It seems to have a cascading check, like</p>
<p><code>if(){}else if{}else if{}else{}</code></p>
<p>type structure, which makes sense for value and index checking.</p>
<p><img src="/blog/images/bg.png" alt="biggraph.png"></p>
<p>So, after some analysis, and guessing, we can figure the following. There is some debouncing/not expected to be perfect for clock cycles for button presses, so there must be tolerance for <code>0xFF00</code> to be the same for multiple cycles, or to be 0 with no penalty.</p>
<p>This means that the previous value must be stored somewhere, and that checks for empty press is somewhere too. From looking at the assembly, and the graph, I can piece together this as pseudocode.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main_checker</span>() {
  byte reg_E;
  byte reg_A;
  byte<span style="color:#f92672">*</span> curr_press <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc0a2</span>;
  byte<span style="color:#f92672">*</span> prev_press <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc0a1</span>;
  byte<span style="color:#f92672">*</span> num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc0a0</span>;
begin:
  reg_E <span style="color:#f92672">=</span> load_joypad_to_e();
  <span style="color:#f92672">*</span>curr_press <span style="color:#f92672">=</span> reg_E;
  reg_A <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>prev_press;
  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>prev_press) {
    <span style="color:#66d9ef">goto</span> begin;
  }
  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x00</span>) {
    <span style="color:#66d9ef">goto</span> begin;
  }
  <span style="color:#66d9ef">do</span> {
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x01</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x02</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">||</span> num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x04</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x08</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x10</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">11</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x20</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">||</span> <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">9</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>curr_press <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x80</span>) {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">==</span> <span style="color:#ae81ff">12</span>) {
        <span style="color:#f92672">*</span>num_correct<span style="color:#f92672">++</span>;
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      }
    } <span style="color:#66d9ef">else</span> {
      <span style="color:#f92672">*</span>num_correct <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    }
	<span style="color:#f92672">*</span>prev_press <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>curr_press;
  } <span style="color:#66d9ef">while</span> (<span style="color:#f92672">*</span>num_correct <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x0D</span>);
  winner();
}

</code></pre></div><p>The only thing left to do is to cross reference the button presses with their values, and extract the order from that code.</p>
<pre><code>4 - up
1 - right
8 - down
2 - left
4 - up
1 - right
8 - down
2 - left
20 - B
20 - B
10 - A
10 - A
80 - Start
---------values-----------------
$80 - Start             $8 - Down
$40 - Select            $4 - Up
$20 - B                 $2 - Left
$10 - A                 $1 - Right
</code></pre><p>Plug it in to VisualBoyAdvance and grab our 200 points!</p>
<p><img src="/blog/images/win.png" alt="win.png"></p>
<p>Thanks to FluxFingers for a great CTF!</p>
<p>Comments? Questions?
<code>crowell@shellphish.net</code></p>

    </section>
</article>

<footer id="post-meta" class="clearfix">
    <a href="https://twitter.com/radareorg">
    <img class="avatar" src="https://radareorg.github.io/blog/images/avatar.png">
    <div>
        <span class="dark">The radare team</span>
        <span></span>
    </div>
    </a>
    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fradareorg.github.io%2fblog%2fposts%2fsolving-at-gunpoint-from-hack-lu-2014-with-radare2%2f - Solving%20%27At%20gunpoint%27%20from%20hack.lu%202014%20with%20radare2 by @radareorg"><span class="icon-twitter"> https://twitter.com/radareorg</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

    </section>
</footer>



<ul id="post-list" class="archive readmore">
    <h3>Read more</h3>

    
    
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/sleigh_disassembler_backend/">GSoC 2020: SLEIGH Disassembler Backend<aside class="dates">Sep 6 2020</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/rsoc-2019-console-interface-improvement/">RSoC 2019 Final: Console Interface Improvements<aside class="dates">Oct 1 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/rsoc-2019-selection/">Radare2 Summer of Code 2019 Selection Results<aside class="dates">Apr 2 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/radare2-survey/">Radare2 Community Survey Results<aside class="dates">Feb 2 2019</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/radare2-bioinformatics/">Radare2 and bioinformatics: a good match?<aside class="dates">Aug 31 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/cutter_debug/">GSoC 2018 Final: Debugging and Emulation Support for Cutter<aside class="dates">Aug 20 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/cli_improvements/">GSoC 2018 Final: Console Interface Improvementes<aside class="dates">Aug 19 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/gsoc_2018_radeco_cfs/">GSoC 2018: Control Flow Structuring for Radeco-lib<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/gsoc_2018_radeco_pseudo_c_code_generation/">Gsoc 2018 Radeco Pseudo C Code Generation<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
        <li>
            <a href="https://radareorg.github.io/blog/posts/type_inference/">GSoC&#39;18 Final: Type inference<aside class="dates">Aug 12 2018</aside></a>
        </li>
    
</ul>



        <footer id="footer">
    
    <p class="small">
    
        The radare team
    
    </p>
</footer>

    </section>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://radareorg.github.io/blog/js/main.js"></script>
<script src="https://radareorg.github.io/blog/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>





</body>
</html>
